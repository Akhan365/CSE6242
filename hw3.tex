\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={HW3:~Logistic~Regression},
            pdfauthor={Ebeid ElSayed - Ebeid@gatech.edu},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{{#1}}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{{#1}}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{{#1}}}
\newcommand{\ImportTok}[1]{{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{{#1}}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{{#1}}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{{#1}}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{{#1}}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{{#1}}}}
\newcommand{\BuiltInTok}[1]{{#1}}
\newcommand{\ExtensionTok}[1]{{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{{#1}}}
\newcommand{\RegionMarkerTok}[1]{{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{{#1}}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{{#1}}}}
\newcommand{\NormalTok}[1]{{#1}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}
  \title{HW3:~Logistic~Regression}
  \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
\subtitle{CSE6242 - Data and Visual Analytics - Spring 2017}
  \author{Ebeid ElSayed -
\href{mailto:Ebeid@gatech.edu}{\nolinkurl{Ebeid@gatech.edu}}}
  \preauthor{\centering\large\emph}
  \postauthor{\par}
  \predate{\centering\large\emph}
  \postdate{\par}
  \date{March 14, 2017}

\usepackage{docmute}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{setwd}\NormalTok{(}\StringTok{"C:/Users/eelsayed/Google Drive/CSE 6242/2017 Spring"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{0. Data Preprocessing}\label{data-preprocessing}

0.a \& 0.b

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rawDatalLoaded <-}\StringTok{ }\OtherTok{TRUE}

\NormalTok{if(}\KeywordTok{file.exists}\NormalTok{(}\StringTok{"mnist_train.csv"}\NormalTok{))\{}
  \NormalTok{train <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\DataTypeTok{file=}\StringTok{"mnist_train.csv"}\NormalTok{, }\DataTypeTok{header =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{\}else\{}
  \NormalTok{rawDatalLoaded <-}\StringTok{ }\OtherTok{FALSE}
\NormalTok{\}}

\NormalTok{if(}\KeywordTok{file.exists}\NormalTok{(}\StringTok{"mnist_test.csv"}\NormalTok{))\{}
  \NormalTok{test <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\DataTypeTok{file=}\StringTok{"mnist_test.csv"}\NormalTok{, }\DataTypeTok{header =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{\}else\{}
  \NormalTok{rawDatalLoaded <-}\StringTok{ }\OtherTok{FALSE}
\NormalTok{\}}

\NormalTok{if(!rawDatalLoaded)\{}
  \KeywordTok{print}\NormalTok{(}\StringTok{"Data wasn't loaded correctly."}\NormalTok{)}
\NormalTok{\}}

\NormalTok{train <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{t}\NormalTok{(train))}
\KeywordTok{names}\NormalTok{(train)[}\DecValTok{785}\NormalTok{] <-}\StringTok{ "Label"}

\NormalTok{test <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(}\KeywordTok{t}\NormalTok{(test))}
\KeywordTok{names}\NormalTok{(test)[}\DecValTok{785}\NormalTok{] <-}\StringTok{ "Label"}
\end{Highlighting}
\end{Shaded}

0.c Partition~the training set for classification of 0, 1 and 3, 5
classes based on the class label (last row 785): train\_0\_1,
train\_3\_5.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{train_0_1 <-}\StringTok{ }\NormalTok{train[(train$Label ==}\StringTok{ }\DecValTok{0}\NormalTok{) |}\StringTok{ }\NormalTok{(train$Label ==}\StringTok{ }\DecValTok{1}\NormalTok{),]}
\NormalTok{train_3_5 <-}\StringTok{ }\NormalTok{train[(train$Label ==}\StringTok{ }\DecValTok{3}\NormalTok{) |}\StringTok{ }\NormalTok{(train$Label ==}\StringTok{ }\DecValTok{5}\NormalTok{),]}
\end{Highlighting}
\end{Shaded}

0.d Do the same for the test set: test\_0\_1, test\_3\_5.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{test_0_1 <-}\StringTok{ }\NormalTok{test[(test$Label ==}\StringTok{ }\DecValTok{0}\NormalTok{) |}\StringTok{ }\NormalTok{(test$Label ==}\StringTok{ }\DecValTok{1}\NormalTok{),]}
\NormalTok{test_3_5 <-}\StringTok{ }\NormalTok{test[(test$Label ==}\StringTok{ }\DecValTok{3}\NormalTok{) |}\StringTok{ }\NormalTok{(test$Label ==}\StringTok{ }\DecValTok{5}\NormalTok{),]}
\end{Highlighting}
\end{Shaded}

0.e \& 0.f \textbar{} Separate the class label from all the partitions
created (remove row 785 from the actual data and store it as a separate
vector).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{true_label_train_0_1 <-}\StringTok{ }\NormalTok{train_0_1$Label}
\NormalTok{train_0_1 <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(train_0_1, }\DataTypeTok{select =} \KeywordTok{names}\NormalTok{(train_0_1) !=}\StringTok{ "Label"} \NormalTok{)}

\NormalTok{true_label_train_3_5 <-}\StringTok{ }\NormalTok{train_3_5$Label}
\NormalTok{train_3_5 <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(train_3_5, }\DataTypeTok{select =} \KeywordTok{names}\NormalTok{(train_3_5) !=}\StringTok{ "Label"} \NormalTok{)}

\NormalTok{true_label_test_0_1 <-}\StringTok{ }\NormalTok{test_0_1$Label}
\NormalTok{test_0_1 <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(test_0_1, }\DataTypeTok{select =} \KeywordTok{names}\NormalTok{(test_0_1) !=}\StringTok{ "Label"} \NormalTok{)}

\NormalTok{true_label_test_3_5 <-}\StringTok{ }\NormalTok{test_3_5$Label}
\NormalTok{test_3_5 <-}\StringTok{ }\KeywordTok{subset}\NormalTok{(test_3_5, }\DataTypeTok{select =} \KeywordTok{names}\NormalTok{(test_3_5) !=}\StringTok{ "Label"} \NormalTok{)}
\end{Highlighting}
\end{Shaded}

0.g Visualize 1 image from each class to ensure you have read in the
data correctly. You will have 4 images corresponding to 0, 1, 3 and 5.
You need to convert the 1D image data into 2D for visualisation.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{show_digit_image <-}\StringTok{ }\NormalTok{function(df, digitClass, imageTitle) \{}
  \NormalTok{tmp <-}\StringTok{ }\NormalTok{df[df$Label ==}\StringTok{ }\NormalTok{digitClass,]}
  \NormalTok{m <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\KeywordTok{unlist}\NormalTok{(tmp[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{:}\DecValTok{784}\NormalTok{]), }\DataTypeTok{ncol =} \DecValTok{28}\NormalTok{, }\DataTypeTok{byrow =} \OtherTok{TRUE}\NormalTok{)}
  \KeywordTok{image}\NormalTok{(}\DataTypeTok{z =} \NormalTok{m, }\DataTypeTok{col =} \KeywordTok{gray.colors}\NormalTok{(}\DecValTok{256}\NormalTok{))}
  \KeywordTok{title}\NormalTok{(}\DataTypeTok{main =} \NormalTok{imageTitle)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{show_digit_image}\NormalTok{(train, }\DecValTok{0}\NormalTok{, }\StringTok{"Class label : 0"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{hw3_files/figure-latex/unnamed-chunk-6-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{show_digit_image}\NormalTok{(train, }\DecValTok{1}\NormalTok{, }\StringTok{"Class label : 1"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{hw3_files/figure-latex/unnamed-chunk-7-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{show_digit_image}\NormalTok{(train, }\DecValTok{3}\NormalTok{, }\StringTok{"Class label : 3"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{hw3_files/figure-latex/unnamed-chunk-8-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{show_digit_image}\NormalTok{(train, }\DecValTok{5}\NormalTok{, }\StringTok{"Class label : 5"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{hw3_files/figure-latex/unnamed-chunk-9-1.pdf}

\subsection{1. Theory}\label{theory}

1.a Write down the formula for computing the gradient of the loss
function used in Logistic Regression. Specify what each variable
represents in the equation.

The formula for the gradient descent is: \[
\theta_j \leftarrow \theta_j - \alpha \sum_{i=1}^{n} \frac{1}{1 + \exp(-y^{(i)} <\theta, x^{(i)}> )}
\] where \(x^{(i)}\) is the data point represented in a vector of
features, \(y^{(i)}\) is the class label, and \(\theta\) is the
parameter vector. The goal is to reach the \(\theta\) that maximizes our
likelihood function (given the data we use to train the model).

1.b Write pseudocode for training a model using Logistic Regression.
\input{algorithm.tex}


\end{document}
